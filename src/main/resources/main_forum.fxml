<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.*?>
<?import javafx.scene.effect.*?>

<?import javafx.geometry.Insets?>
<AnchorPane fx:id="rootPane"
            xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="controllers.MainForumController"
            style="-fx-background-color: radial-gradient(center 50% 50%, radius 70%, #667eea, #5a67d8);"
            prefWidth="1300" prefHeight="750">

    <!-- Ã‰LÃ‰MENTS DÃ‰CORATIFS SANS GAUSSIANBLUR -->
    <Circle radius="300" fill="#9F7AEA" opacity="0.15" layoutX="-100" layoutY="-50"/>
    <Circle radius="400" fill="#ED64A6" opacity="0.1" layoutX="1100" layoutY="600"/>

    <VBox layoutX="30" layoutY="30" prefWidth="1240" prefHeight="690"
          style="-fx-background-color: rgba(255,255,255,0.95); -fx-background-radius: 40;
                 -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.25), 30, 0.3, 0, 10);">

        <padding><Insets top="25" right="30" bottom="25" left="30"/></padding>

        <!-- HEADER -->
        <VBox spacing="20" style="-fx-background-color: linear-gradient(to right, #667eea, #764ba2);
               -fx-background-radius: 30; -fx-padding: 25;
               -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 15, 0.2, 0, 5);">

            <HBox alignment="CENTER_LEFT" spacing="20">
                <HBox spacing="15" alignment="CENTER">
                    <Circle radius="25" fill="white" opacity="0.2"/>
                    <Label text="ðŸ§ " style="-fx-font-size: 40px; -fx-effect: dropshadow(gaussian, white, 10, 0.3, 0, 0);"/>
                    <VBox spacing="3">
                        <Label text="GROWMIND"
                               style="-fx-font-size: 32px; -fx-font-weight: 900; -fx-text-fill: white;
                                      -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 5, 0, 0, 2);"/>
                        <Label text="Forum SantÃ© Mentale &amp; Bien-Ãªtre"
                               style="-fx-font-size: 14px; -fx-text-fill: rgba(255,255,255,0.95); -fx-font-weight: 600;"/>
                    </VBox>
                </HBox>
                <Pane HBox.hgrow="ALWAYS"/>
                <HBox spacing="15">
                    <Label fx:id="lblDate"
                           style="-fx-background-color: rgba(255,255,255,0.2); -fx-padding: 10 25;
                                  -fx-background-radius: 30; -fx-text-fill: white; -fx-font-weight: 700;"/>
                    <Label fx:id="lblUserRole" text="ðŸŒ± Nouveau"
                           style="-fx-background-color: rgba(255,255,255,0.25); -fx-padding: 10 25;
                                  -fx-background-radius: 30; -fx-text-fill: white; -fx-font-weight: 700;
                                  -fx-border-color: rgba(255,255,255,0.5); -fx-border-width: 1; -fx-border-radius: 30;"/>
                </HBox>
            </HBox>

            <!-- NAVIGATION -->
            <HBox spacing="15" alignment="CENTER_LEFT">
                <Button text="ðŸ’¬ Forum" onAction="#handleForum"
                        style="-fx-background-color: rgba(255,255,255,0.3); -fx-text-fill: white;
                               -fx-font-weight: 700; -fx-background-radius: 30; -fx-padding: 12 25;
                               -fx-cursor: hand; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);"/>
                <Button text="âž• Nouvelle discussion" onAction="#handleNouvelleDiscussion"
                        style="-fx-background-color: #FBBF24; -fx-text-fill: #1A202C; -fx-font-weight: 800;
                               -fx-background-radius: 30; -fx-padding: 12 25; -fx-cursor: hand;
                               -fx-effect: dropshadow(gaussian, rgba(251,191,36,0.4), 10, 0, 0, 2);"/>
                <Button text="ðŸ‘¥ Patients" onAction="#handleEspacePatient"
                        style="-fx-background-color: transparent; -fx-text-fill: white;
                               -fx-background-radius: 30; -fx-padding: 12 25; -fx-cursor: hand;
                               -fx-border-color: rgba(255,255,255,0.5); -fx-border-width: 1; -fx-border-radius: 30;"/>
                <Button text="ðŸ‘¨â€âš•ï¸ MÃ©decins" onAction="#handleEspaceMedecin"
                        style="-fx-background-color: transparent; -fx-text-fill: white;
                               -fx-background-radius: 30; -fx-padding: 12 25; -fx-cursor: hand;
                               -fx-border-color: rgba(255,255,255,0.5); -fx-border-width: 1; -fx-border-radius: 30;"/>
                <Button text="ðŸ“š Ressources" onAction="#handleRessources"
                        style="-fx-background-color: transparent; -fx-text-fill: white;
                               -fx-background-radius: 30; -fx-padding: 12 25; -fx-cursor: hand;
                               -fx-border-color: rgba(255,255,255,0.5); -fx-border-width: 1; -fx-border-radius: 30;"/>
                <Button text="ðŸ†˜ Urgence" onAction="#handleUrgence"
                        style="-fx-background-color: #E53E3E; -fx-text-fill: white; -fx-font-weight: 800;
                               -fx-background-radius: 30; -fx-padding: 12 25; -fx-cursor: hand;
                               -fx-effect: dropshadow(gaussian, rgba(229,62,62,0.4), 10, 0, 0, 2);"/>
                <Button fx:id="btnSwitchRole" text="ðŸ”„ Changer rÃ´le" onAction="#handleSwitchRole"
                        style="-fx-background-color: #9F7AEA; -fx-text-fill: white; -fx-font-weight: 700;
                               -fx-background-radius: 30; -fx-padding: 12 25; -fx-cursor: hand;
                               -fx-effect: dropshadow(gaussian, rgba(159,122,234,0.4), 8, 0, 0, 2);"/>
            </HBox>
        </VBox>

        <!-- CONTENU PRINCIPAL -->
        <ScrollPane fitToWidth="true" fitToHeight="true" hbarPolicy="NEVER"
                    style="-fx-background-color: transparent; -fx-background: transparent; -fx-border-color: transparent;">

            <VBox spacing="35" style="-fx-padding: 30 0 30 0; -fx-background-color: transparent;">

                <!-- STATISTIQUES -->
                <HBox spacing="25" alignment="CENTER">
                    <VBox spacing="10" alignment="CENTER" HBox.hgrow="ALWAYS"
                          style="-fx-background-color: linear-gradient(to bottom, white, #F7FAFC);
                                 -fx-padding: 25; -fx-background-radius: 30;
                                 -fx-effect: dropshadow(gaussian, rgba(102,126,234,0.2), 15, 0, 0, 5);
                                 -fx-border-color: #667eea; -fx-border-width: 2; -fx-border-radius: 30;">
                        <Circle radius="35" fill="#667eea" opacity="0.2"/>
                        <Label text="ðŸ‘¥" style="-fx-font-size: 40px;"/>
                        <Label fx:id="lblPatientsCount" text="1,254"
                               style="-fx-font-size: 28px; -fx-font-weight: 900; -fx-text-fill: #667eea;"/>
                        <Label text="Patients" style="-fx-font-size: 14px; -fx-text-fill: #4A5568; -fx-font-weight: 600;"/>
                    </VBox>

                    <VBox spacing="10" alignment="CENTER" HBox.hgrow="ALWAYS"
                          style="-fx-background-color: linear-gradient(to bottom, white, #F7FAFC);
                                 -fx-padding: 25; -fx-background-radius: 30;
                                 -fx-effect: dropshadow(gaussian, rgba(74,111,165,0.2), 15, 0, 0, 5);
                                 -fx-border-color: #4A6FA5; -fx-border-width: 2; -fx-border-radius: 30;">
                        <Circle radius="35" fill="#4A6FA5" opacity="0.2"/>
                        <Label text="ðŸ‘¨â€âš•ï¸" style="-fx-font-size: 40px;"/>
                        <Label fx:id="lblMedecinsCount" text="89"
                               style="-fx-font-size: 28px; -fx-font-weight: 900; -fx-text-fill: #4A6FA5;"/>
                        <Label text="MÃ©decins" style="-fx-font-size: 14px; -fx-text-fill: #4A5568; -fx-font-weight: 600;"/>
                    </VBox>

                    <VBox spacing="10" alignment="CENTER" HBox.hgrow="ALWAYS"
                          style="-fx-background-color: linear-gradient(to bottom, white, #F7FAFC);
                                 -fx-padding: 25; -fx-background-radius: 30;
                                 -fx-effect: dropshadow(gaussian, rgba(242,193,78,0.2), 15, 0, 0, 5);
                                 -fx-border-color: #F2C14E; -fx-border-width: 2; -fx-border-radius: 30;">
                        <Circle radius="35" fill="#F2C14E" opacity="0.2"/>
                        <Label text="ðŸ’¬" style="-fx-font-size: 40px;"/>
                        <Label fx:id="lblPostsCount" text="0"
                               style="-fx-font-size: 28px; -fx-font-weight: 900; -fx-text-fill: #F2C14E;"/>
                        <Label text="Publications" style="-fx-font-size: 14px; -fx-text-fill: #4A5568; -fx-font-weight: 600;"/>
                    </VBox>

                    <VBox spacing="10" alignment="CENTER" HBox.hgrow="ALWAYS"
                          style="-fx-background-color: linear-gradient(to bottom, white, #F7FAFC);
                                 -fx-padding: 25; -fx-background-radius: 30;
                                 -fx-effect: dropshadow(gaussian, rgba(46,204,113,0.2), 15, 0, 0, 5);
                                 -fx-border-color: #2ECC71; -fx-border-width: 2; -fx-border-radius: 30;">
                        <Circle radius="35" fill="#2ECC71" opacity="0.2"/>
                        <Label text="ðŸ’­" style="-fx-font-size: 40px;"/>
                        <Label fx:id="lblReponsesCount" text="0"
                               style="-fx-font-size: 28px; -fx-font-weight: 900; -fx-text-fill: #2ECC71;"/>
                        <Label text="RÃ©ponses" style="-fx-font-size: 14px; -fx-text-fill: #4A5568; -fx-font-weight: 600;"/>
                    </VBox>
                </HBox>

                <!-- SECTION BIENVENUE -->
                <VBox alignment="CENTER" spacing="20" style="-fx-padding: 20 0 30 0;">
                    <Label text="ðŸŒ±" style="-fx-font-size: 64px; -fx-effect: dropshadow(gaussian, #667eea, 20, 0.4, 0, 2);"/>
                    <Label text="Bienvenue sur GrowMind"
                           style="-fx-font-size: 36px; -fx-font-weight: 900;
                                  -fx-text-fill: linear-gradient(to right, #2C3E50, #1A202C);
                                  -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);"/>
                    <Label text="Cultivez votre bien-Ãªtre mental, Ã©changez avec la communautÃ©"
                           style="-fx-font-size: 16px; -fx-text-fill: #718096; -fx-font-weight: 500;"/>

                    <HBox spacing="20" style="-fx-padding: 20 0 0 0;">
                        <Button text="âœ¨ Commencer une discussion" onAction="#handleNouvelleDiscussion"
                                style="-fx-background-color: linear-gradient(to right, #667eea, #764ba2);
                                       -fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: 800;
                                       -fx-padding: 15 40; -fx-background-radius: 40; -fx-cursor: hand;
                                       -fx-effect: dropshadow(gaussian, rgba(102,126,234,0.4), 15, 0, 0, 3);"/>
                        <Button text="ðŸ’¬ Voir le forum" onAction="#handleForum"
                                style="-fx-background-color: white; -fx-text-fill: #667eea; -fx-font-size: 16px;
                                       -fx-font-weight: 700; -fx-padding: 15 40; -fx-background-radius: 40;
                                       -fx-cursor: hand; -fx-border-color: #667eea; -fx-border-width: 2;
                                       -fx-border-radius: 40; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 10, 0, 0, 2);"/>
                    </HBox>
                </VBox>

                <!-- THÃ‰MATIQUES POPULAIRES -->
                <VBox spacing="20">
                    <HBox alignment="CENTER_LEFT" spacing="15">
                        <Label text="ðŸ”¥" style="-fx-font-size: 28px;"/>
                        <Label text="ThÃ©matiques populaires"
                               style="-fx-font-size: 22px; -fx-font-weight: 900; -fx-text-fill: #2C3E50;"/>
                    </HBox>

                    <FlowPane hgap="15" vgap="15" alignment="CENTER_LEFT">
                        <Button text="ðŸ˜Ÿ AnxiÃ©tÃ©"
                                style="-fx-background-color: #FEE2E2; -fx-text-fill: #DC2626;
                                       -fx-font-weight: 700; -fx-background-radius: 40; -fx-padding: 12 30;
                                       -fx-border-color: #FCA5A5; -fx-border-width: 1; -fx-border-radius: 40;
                                       -fx-cursor: hand;"/>
                        <Button text="ðŸ§  Stress"
                                style="-fx-background-color: #FEF3C7; -fx-text-fill: #D97706;
                                       -fx-font-weight: 700; -fx-background-radius: 40; -fx-padding: 12 30;
                                       -fx-border-color: #FCD34D; -fx-border-width: 1; -fx-border-radius: 40;
                                       -fx-cursor: hand;"/>
                        <Button text="ðŸ˜¢ DÃ©pression"
                                style="-fx-background-color: #DBEAFE; -fx-text-fill: #2563EB;
                                       -fx-font-weight: 700; -fx-background-radius: 40; -fx-padding: 12 30;
                                       -fx-border-color: #93C5FD; -fx-border-width: 1; -fx-border-radius: 40;
                                       -fx-cursor: hand;"/>
                        <Button text="ðŸ§˜ MÃ©ditation"
                                style="-fx-background-color: #D1FAE5; -fx-text-fill: #059669;
                                       -fx-font-weight: 700; -fx-background-radius: 40; -fx-padding: 12 30;
                                       -fx-border-color: #6EE7B7; -fx-border-width: 1; -fx-border-radius: 40;
                                       -fx-cursor: hand;"/>
                        <Button text="ðŸ’¤ Sommeil"
                                style="-fx-background-color: #E0E7FF; -fx-text-fill: #4F46E5;
                                       -fx-font-weight: 700; -fx-background-radius: 40; -fx-padding: 12 30;
                                       -fx-border-color: #A5B4FC; -fx-border-width: 1; -fx-border-radius: 40;
                                       -fx-cursor: hand;"/>
                        <Button text="ðŸ’ª Estime de soi"
                                style="-fx-background-color: #FEE2E2; -fx-text-fill: #B45309;
                                       -fx-font-weight: 700; -fx-background-radius: 40; -fx-padding: 12 30;
                                       -fx-border-color: #FCA5A5; -fx-border-width: 1; -fx-border-radius: 40;
                                       -fx-cursor: hand;"/>
                    </FlowPane>
                </VBox>

                <!-- RESSOURCES ET AIDE -->
                <HBox spacing="25" alignment="CENTER">
                    <VBox spacing="15" HBox.hgrow="ALWAYS"
                          style="-fx-background-color: linear-gradient(135deg, #FEE2E2, #FFD1D1);
                                 -fx-padding: 25; -fx-background-radius: 25;
                                 -fx-border-color: #EF4444; -fx-border-width: 1; -fx-border-radius: 25;
                                 -fx-effect: dropshadow(gaussian, rgba(239,68,68,0.1), 15, 0, 0, 5);">
                        <HBox alignment="CENTER_LEFT" spacing="15">
                            <Circle radius="25" fill="#EF4444" opacity="0.2"/>
                            <Label text="ðŸ†˜" style="-fx-font-size: 32px;"/>
                            <VBox>
                                <Label text="AIDE D'URGENCE 24/7"
                                       style="-fx-font-size: 18px; -fx-font-weight: 900; -fx-text-fill: #DC2626;"/>
                                <Label text="Appel gratuit et confidentiel"
                                       style="-fx-font-size: 12px; -fx-text-fill: #6B7280;"/>
                            </VBox>
                        </HBox>
                        <Label text="ðŸ“ž 3114"
                               style="-fx-font-size: 28px; -fx-font-weight: 900; -fx-text-fill: white;
                                      -fx-background-color: #DC2626; -fx-padding: 10 25; -fx-background-radius: 40;
                                      -fx-alignment: center; -fx-effect: dropshadow(gaussian, rgba(220,38,38,0.3), 10, 0, 0, 2);"/>
                    </VBox>

                    <VBox spacing="15" HBox.hgrow="ALWAYS"
                          style="-fx-background-color: linear-gradient(135deg, #D1FAE5, #A7F3D0);
                                 -fx-padding: 25; -fx-background-radius: 25;
                                 -fx-border-color: #10B981; -fx-border-width: 1; -fx-border-radius: 25;
                                 -fx-effect: dropshadow(gaussian, rgba(16,185,129,0.1), 15, 0, 0, 5);">
                        <HBox alignment="CENTER_LEFT" spacing="15">
                            <Circle radius="25" fill="#10B981" opacity="0.2"/>
                            <Label text="ðŸ“š" style="-fx-font-size: 32px;"/>
                            <VBox>
                                <Label text="RESSOURCES BIEN-ÃŠTRE"
                                       style="-fx-font-size: 18px; -fx-font-weight: 900; -fx-text-fill: #059669;"/>
                                <Label text="Applications et livres"
                                       style="-fx-font-size: 12px; -fx-text-fill: #6B7280;"/>
                            </VBox>
                        </HBox>
                        <FlowPane hgap="10" vgap="10">
                            <Button text="ðŸ§˜ Petit BamBou"
                                    style="-fx-background-color: white; -fx-text-fill: #059669; -fx-font-weight: 600;
                                           -fx-background-radius: 30; -fx-padding: 8 20; -fx-cursor: hand;
                                           -fx-border-color: #059669; -fx-border-width: 1; -fx-border-radius: 30;"/>
                            <Button text="ðŸŒ¿ Mindfulness"
                                    style="-fx-background-color: white; -fx-text-fill: #059669; -fx-font-weight: 600;
                                           -fx-background-radius: 30; -fx-padding: 8 20; -fx-cursor: hand;
                                           -fx-border-color: #059669; -fx-border-width: 1; -fx-border-radius: 30;"/>
                            <Button text="ðŸ˜Œ Calm"
                                    style="-fx-background-color: white; -fx-text-fill: #059669; -fx-font-weight: 600;
                                           -fx-background-radius: 30; -fx-padding: 8 20; -fx-cursor: hand;
                                           -fx-border-color: #059669; -fx-border-width: 1; -fx-border-radius: 30;"/>
                        </FlowPane>
                    </VBox>
                </HBox>

                <!-- RECHERCHE -->
                <HBox spacing="15" alignment="CENTER">
                    <HBox spacing="10" style="-fx-background-color: white; -fx-padding: 5 20;
                          -fx-background-radius: 40; -fx-border-color: #E2E8F0; -fx-border-width: 1;
                          -fx-border-radius: 40; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.02), 5, 0, 0, 2);"
                          HBox.hgrow="ALWAYS">
                        <Label text="ðŸ”" style="-fx-font-size: 18px;"/>
                        <TextField fx:id="searchField" promptText="Rechercher une discussion..."
                                   HBox.hgrow="ALWAYS" style="-fx-background-color: transparent;
                                   -fx-border-color: transparent; -fx-font-size: 14px;"/>
                    </HBox>
                    <Button text="Rechercher" onAction="#handleSearch"
                            style="-fx-background-color: #667eea; -fx-text-fill: white; -fx-font-weight: 700;
                                   -fx-background-radius: 40; -fx-padding: 12 35; -fx-cursor: hand;
                                   -fx-effect: dropshadow(gaussian, rgba(102,126,234,0.3), 8, 0, 0, 2);"/>
                </HBox>
            </VBox>
        </ScrollPane>
    </VBox>
</AnchorPane>